name: build and test
runs:
  using: composite
  steps:
    - name: Setup go
      uses: actions/setup-go@v4
      with:
        go-version-file: ./go.mod

    - name: Run go vet
      shell: bash
      run: go vet ./...

    - name: Run Staticcheck
      shell: bash
      run: |
        go install honnef.co/go/tools/cmd/staticcheck@latest && \
        staticcheck ./...

    - name: Test the source
      shell: bash
      run: go test ./...
